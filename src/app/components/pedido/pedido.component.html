<app-navigation></app-navigation>

<div class="card">
    <h3 class="card-header text-center font-weight-bold text-uppercase py-4">Nuevo Pedido</h3>
    <div class="card-body">
        <div id="table" class="table-editable">
            <span class="table-add float-right mb-3 mr-2">
                <button class="btn btn-primary mr-2" (click)="nuevoV2()">Nuevo</button>
                <button class="btn btn-danger" routerLink="/pedidos"><i class="fa fa-arrow-left"></i>Regresar</button>
            </span>
            <span class="table-add float-left mb-3 mr-2">
                <input class="form-control" type="text" placeholder="nombre_cliente" (blur)="actualizarCliente($event)">
            </span>
            <table class="table table-bordered table-responsive-md table-striped text-center">
                <tr>
                    <th class="text-center">id</th>
                    <th class="text-center">nombre_producto</th>
                    <th class="text-center">cantidad</th>
                    <th class="text-center">precio</th>
                    <th class="text-center">sujeto_iva</th>
                    <th class="text-center">subtotal_0</th>
                    <th class="text-center">subtotal_12</th>
                    <th class="text-center">iva</th>
                    <th class="text-center">total</th>
                    <th class="text-center">acciones</th>
                </tr>
                <tr *ngFor="let producto of listaProducto; let id = index">
                    <td>
                        <span contenteditable="false">{{producto.id}}</span>
                    </td>
                    <td>
                        <input class="form-control-sm" type="text" placeholder="nombre_producto" (blur)="actualizarListaV2(id, 'nombre_producto', $event)">
                    </td>
                    <td>
                        <input class="form-control-sm " type="number" placeholder="cantidad" 
                        (blur)="actualizarListaV2(id, 'cantidad', $event); calcularSubtotales(id, 'subtotal_0', $event)">
                    </td>
                    <td>
                        <input class="form-control-sm" type="number" placeholder="precio" 
                        (blur)="actualizarListaV2(id, 'precio', $event); calcularSubtotales(id, 'subtotal_0', $event)">
                    </td>
                    <td>
                        <input class="form-control" type="checkbox" 
                        (click)="actualizarListaV2(id, 'sujeto_iva', $event); calcularSubtotales(id, 'subtotal_12', $event)">
                    </td>
                    <td>
                        <span contenteditable="false">{{producto.subtotal_0}}</span>
                    </td>
                    <td>
                        <span contenteditable="false">{{producto.subtotal_12}}</span>
                    </td>
                    <td>
                        <span contenteditable="false">{{producto.iva}}</span>
                    </td>
                    <td>
                        <span contenteditable="false">{{producto.total}}</span>
                    </td>
                    <td>
                        <span class="table-remove">
                            <button type="button" mdbBtn color="danger" rounded="true" size="sm" class="my-0"
                                (click)="eliminar(id)">Eliminar</button>
                        </span>
                    </td>
                </tr>
            </table>
            <span class="table-add float-right mb-3 mr-2">
                <button class="btn btn-primary mr-2" (click)="guardar()">Guardar</button>
            </span>
        </div>
    </div>
</div>
<!-- Editable table -->